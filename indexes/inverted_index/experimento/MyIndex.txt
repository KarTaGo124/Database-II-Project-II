-- CREACIÓN DE TABLAS

CREATE TABLE amazon1000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon2000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon4000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon8000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon16000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon32000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
);

CREATE TABLE amazon64000 (
    doc_id INT KEY INDEX ISAM,
    text VARCHAR[5000]
)

-- CARGA DE DATOS

LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_1000.csv" INTO amazon1000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_2000.csv" INTO amazon2000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_4000.csv" INTO amazon4000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_8000.csv" INTO amazon8000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_16000.csv" INTO amazon16000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_32000.csv" INTO amazon32000;
LOAD DATA FROM FILE "data/datasets/amazon_reviews/corpus_64000.csv" INTO amazon64000;

-- CREACIÓN DE ÍNDICES INVERTIDOS

CREATE INDEX ON amazon1000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon2000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon4000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon8000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon16000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon32000 (text) USING INVERTED_TEXT LANGUAGE "english";
CREATE INDEX ON amazon64000 (text) USING INVERTED_TEXT LANGUAGE "english";

-- CONSULTAS

-- Consulta 1000
SELECT doc_id, text FROM amazon1000
WHERE text @@ "battery";

-- Consulta 2000
SELECT doc_id, text FROM amazon2000
WHERE text @@ "wonderful product";

-- Consulta 4000
SELECT doc_id, text FROM amazon4000
WHERE text @@ "amazing";

-- Consulta 8000
SELECT doc_id, text FROM amazon8000
WHERE text @@ "refund";

-- Consulta 16000
SELECT doc_id, text FROM amazon16000
WHERE text @@ "functional";

-- Consulta 32000
SELECT doc_id, text FROM amazon32000
WHERE text @@ "recommended";

-- Consulta 64000
SELECT doc_id, text FROM amazon64000
WHERE text @@ "cheap";
